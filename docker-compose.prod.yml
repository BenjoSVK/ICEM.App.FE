# Production Docker Compose with HTTPS (SSL/TLS)
# Requires SSL certificates in ./certs/ (fullchain.pem, privkey.pem)
# See docs/HTTPS_PRODUCTION.md for obtaining certificates (e.g. Let's Encrypt).

services:
  vgg_histo_fe:
    container_name: vgg_histo_frontend
    image: tanczi0810/ikem-fe:1.0.0
    build:
      context: .
      args:
        REACT_APP_FAST_API_HOST: ""
    ports:
      - "80:80"    # HTTP (redirect to HTTPS)
      - "443:443"  # HTTPS
    volumes:
      - ./nginx.prod.conf:/etc/nginx/conf.d/default.conf:ro
      - ./certs:/etc/nginx/ssl:ro
      - ./logs:/var/log/nginx
    networks:
      - vgg_histo_network
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: unless-stopped

networks:
  vgg_histo_network:
    external: true
